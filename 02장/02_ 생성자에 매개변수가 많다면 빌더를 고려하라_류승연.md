# 아이템 2. 생성자에 매개변수가 많다면 빌더를 고려하라.

static 팩터리와 public 생성자 모두 선택적 매개변수가 많을 때 뷸편하다는 것이다.

## 대안 1. 생성자

원하는 매개변수를 모두 포함한 생성자 중 가장 짧은 것을 골라 호출하면 된다.
```java
NutritionFacts cocaCola = new NutritionFacts(240, 8, 100, 0, 35, 27);
```

그러나, **점층적 생성자 패턴도 쓸 수는 있지만, 매개변수 개수가 많아지면 클라이언트 코드가 작성하거나 읽기 어렵다는 것이다.**
각 값의 의미가 무엇인지, 매개변수가 몇 개인지도 헷갈릴 수 있다.

## 대안 2. 자바빈즈 패턴

자바빈즈 패턴이란? 매개변수가 없는 생성자로 객체를 만든 후, 세터 메서드들을 호출해 원하는 매개변수의 값을 설정하는 방식이다.

점층적 생성자 패턴의 단점들(값의 의미 등)은 보이지는 않지만, <br>
**객체 하나를 만들려면 메서드를 여러 개 호출해야 하고, 객체가 완전히 생성되기 전까지는 일관성이 무너진 상태에 놓이게 된다.**
이 말은 자바빈이 중간에 사용되는 경우 안정적이지 않다는 것이며, (게터와 세터가 있어서) 
불변 클래스로 만들지 못한다는 단점이 있고 (쓰레드 간에 공유 가능한 상태가 있으니까) 쓰레드 안정성을 보장하려면 추가적인 수고 (locking 같은)가 필요하다.

단점을 완화하기 위한 '얼리고(freezing)'이 있지만 거의 쓰이지 않는다.

## 대안 3. 빌더 패턴

점층적 생성자 패턴의 안전성과 자바빈즈 패턴의 가독성 장점만 가졌다.

필요한 객체를 직접 만드는 대신, 필수 매개변수만으로 생성자(혹은 static 팩터리)를 호출해 빌더 객체를 얻는다.
그런 다음 빌더 객체가 제공하는 일종의 세터 메서드들로 원하는 선택 매개변수들을 설정한다.
마지막으로 매개변수가 없는 build 메서드를 호출해 필요한 객체를 얻는다.

```java
//(240,8) :필수적, 부가적인 값들은 세팅한 후, build 호출해서 객체 완성 
NutritionFacts cocaCola = new NutritionFacts.Builder(240, 8)
        .calories(100).sodium(35).carbonhydrate(27).build();
```

빌더의 생성자나 메소드에서 유효성 확인을 할 수도 있고 여러 매개변수를 조합해서 확인해야 하는 경우에는 build 메소드에서 호출하는 생성자에서 할 수 있다.
빌더에서 매개변수를 객체로 복사해온 다음에 확인하고, 검증에 실패하면 IllegalArgumemntExcception을 던지고 에러 메세지로 어떤 매개변수가 잘못됐는지 알려줄 수 있다.

**빌더 패턴은 계층적으로 설계된 클래스와 함께 쓰기에 좋다.** 하위 클래스의 빌더가 정의한 build 메서드는 해당하는 구체 하위 클래스를 반환하도록 선언한다.

빌더는 가변인자 매개변수를 여러개 사용가능하다. (생성자나 팩토리는 가변인자를 맨 마지막 매개변수에 한번밖에 사용 못한다.) 
토핑 예제에서 본 것처럼 여러 메소드 호출을 통해 전달받은 매개변수를 모아 하나의 필드에 담는 것도 가능하다.
빌더 하나로 여러 객체를 생성할수도 매번 생성하는 객체를 변화줄 수도 있다.

그러나 단점으로 객체를 만들기 전에 먼저 빌더를 만들어야 하는데 성능이 민감한 상황에서는 이 점이 문제가 될 수도 있다.
그리고 생성자를 사용하는 것보다 코드가 더 장황하다.
따라서 빌더 패턴은 매개변수가 많거나(4개 이상) 또는 늘어날 가능성이 있는 경우에 사용하는 것이 좋다.

Lombok (Builder) 도 한번 알아보자<br>
lombock을 사용하고 있다면 @Builder 어노테이션을 사용하여 자동으로 빌더패턴을 적용할 수 있다.










